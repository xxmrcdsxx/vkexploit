### Con7ext
### Exploit-Kita
### Usage: python file.py list.txt
import os
import requests
import sys
from multiprocessing.dummy import Pool
from requests.packages.urllib3.exceptions import InsecureRequestWarning
from colorama import Fore as F
from colorama import *

requests.packages.urllib3.disable_warnings(InsecureRequestWarning)
pwd = os.getcwd()
listSite = sys.argv[1]
op = [i.strip() for i in open(listSite, "r").readlines()]

def check(site):
  try:
    r = requests.get(site + "/DesktopModules/Admin/RadEditorProvider/DialogHandler.aspx", verify=False, timeout=10)
    ff = open("vuln.txt", "a+")
    if "Loading the dialog" in r.text:
      print(F.GREEN + Style.BRIGHT + site + "/DesktopModules/Admin/RadEditorProvider/DialogHandler.aspx -> Vuln" + F.RESET + Style.RESET_ALL)
      ff.write(site + "/DesktopModules/Admin/RadEditorProvider/DialogHandler.aspx\n")
    else:
      c = requests.get(site + "/providers/htmleditorproviders/telerik/telerik.web.ui.dialoghandler.aspx", verify=False, timeout=10)
      if "Loading the dialog" in c.text:
        print(F.GREEN + Style.BRIGHT + site + "/providers/htmleditorproviders/telerik/telerik.web.ui.dialoghandler.aspx -> Vuln" + F.RESET + Style.RESET_ALL)
        ff.write(site + "/providers/htmleditorproviders/telerik/telerik.web.ui.dialoghandler.aspx\n")
      else:
        b = requests.get(site + "/desktopmodules/telerikwebui/radeditorprovider/telerik.web.ui.dialoghandler.aspx", verify=False, timeout=10)
        if "Loading the dialog" in b.text:
          print(F.GREEN + Style.BRIGHT + site + "/desktopmodules/telerikwebui/radeditorprovider/telerik.web.ui.dialoghandler.aspx -> Vuln" + F.RESET + Style.RESET_ALL)
          ff.write(site + "/desktopmodules/telerikwebui/radeditorprovider/telerik.web.ui.dialoghandler.aspx\n")
        else:
          k = requests.get(site + "/desktopmodules/dnnwerk.radeditorprovider/dialoghandler.aspx", verify=False, timeout=10)
          if "Loading the dialog" in k.text:
            print(F.GREEN + Style.BRIGHT + site + "/desktopmodules/dnnwerk.radeditorprovider/dialoghandler.aspx -> Vuln" + F.RESET + Style.RESET_ALL)
            ff.write(site + "/desktopmodules/dnnwerk.radeditorprovider/dialoghandler.aspx\n")
          else:
               bruh = requests.get(site + "/Providers/HtmlEditorProviders/Telerik/Telerik.Web.UI.DialogHandler.aspx", verify=False, timeout=10)
	       if "Loading the dialog" in bruh.text:
                  print(F.GREEN + Style.BRIGHT + site + "/Providers/HtmlEditorProviders/Telerik/Telerik.Web.UI.DialogHandler.aspx -> Vuln" + F.RESET + Style.RESET_ALL)
		  ff.write(site + "/Providers/HtmlEditorProviders/Telerik/Telerik.Web.UI.DialogHandler.aspx\n")
               else:
                    aka = requests.get(site + "/Components/General/Admin/UserControl/Telerik.Web.UI.DialogHandler.aspx", verify=False, timeout=10)
                    if "Loading the dialog" in aka.text:
                       print(F.GREEN + Style.BRIGHT + site + "/Components/General/Admin/UserControl/Telerik.Web.UI.DialogHandler.aspx -> Vuln" + F.RESET + Style.RESET_ALL)
		       ff.write(site + "/Components/General/Admin/UserControl/Telerik.Web.UI.DialogHandler.aspx\n")
                    else:
                       print(site + " -> Not Vuln")
  except:
    print(site + " -> Unknow Error")

tod = Pool(150)
tod.map(check, op)
tod.close()
tod.join()

print("\n[+] Saved: {}/vuln.txt".format(pwd))



